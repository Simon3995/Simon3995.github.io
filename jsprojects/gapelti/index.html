<!DOCTYPE html>
<html>

<canvas id="canvas"></canvas><br><br>

<audio class="sfx" id="jump" src="sounds\jump.wav" preload="auto"></audio>
<audio class="sfx" id="win" src="sounds\win.wav" preload="auto"></audio>
<audio class="sfx" id="death" src="sounds\death.wav" preload="auto"></audio>
<style>
canvas {
	border:2px solid #000;
}
body {
	background-color : #696969;
}
</style>
</html>
<script type="text/javascript">
!function(){var e=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame;window.requestAnimationFrame=e}();var channel_max=10;for(audiochannels=new Array,a=0;a<channel_max;a++)audiochannels[a]=new Array,audiochannels[a].channel=new Audio,audiochannels[a].finished=-1;function play_multi_sound(e){for(a=0;a<audiochannels.length;a++)thistime=new Date}var canvas=document.getElementById("canvas"),ctx=canvas.getContext("2d"),width=800,height=200,keys=[],friction=.8,gravity=.4;nnPerGen=10;var nn=[],gatesAmt=35;for(i=1;i<=nnPerGen;i++)for(nn[i]=[],nn[i][0]=[],j=1;j<=gatesAmt;j++)nn[i][j]=[],nn[i][j][1]=!1;var blood={amt:100,x:[],y:[],velx:[],vely:[],size:4,limit:15,vector:[]},eye={amt:361,dist:12},obDim=Math.floor(Math.sqrt(eye.amt)),mouseX=0,mouseY=0,deathwall=-300,lastfitness=0,boxes=[];for(sensorOutput=[],i=0;i<=obDim;i++)sensorOutput[i]=[];if(temp=prompt("Input level here. You can enter 'standard' to load the standard level.","standard"),"standard"===temp){boxes.push({x:-5,y:height-5,width:120,height:1e3,type:0}),boxes.push({x:300,y:height-5,width:120,height:1e3,type:0}),boxes.push({x:-1e3,y:-500,width:1e3,height:2e3,type:0}),boxes.push({x:width,y:0,width:1e3,height:height,type:0}),spawnX=20,spawnY=height/2;var finishX=785;canvas.width=width,canvas.height=height,boxes.push({x:40,y:height-30,width:40,height:30,type:0}),boxes.push({x:150,y:height-100,width:40,height:30,type:0}),boxes.push({x:160,y:height-100,width:20,height:300,type:0}),boxes.push({x:460,y:height-60,width:40,height:300,type:0}),boxes.push({x:520,y:height-90,width:40,height:300,type:0}),boxes.push({x:580,y:height-120,width:40,height:300,type:0}),boxes.push({x:700,y:170,width:2e3,height:600,type:0}),boxes.push({x:700,y:-500,width:300,height:630,type:0}),boxes.push({x:360,y:-500,width:15,height:680,type:1}),boxes.push({x:670,y:-500,width:30,height:515,type:1}),boxes.push({x:finishX,y:130,width:15,height:40,type:2})}else{for(level=temp.split("%"),level[0]=level[0].split(","),spawnX=Number(level[0][0]),spawnY=Number(level[0][1]),level[1]=level[1].split(","),canvas.width=Number(level[1][0]),canvas.height=Number(level[1][1]),temp5=level[2].split("#"),i=1;i<=temp5[0];i++)temp2=temp5[i].split(","),boxes[i]={x:Number(temp2[0]),y:Number(temp2[1]),width:Number(temp2[2]),height:Number(temp2[3]),type:Number(temp2[4])};temp5=level[3].split(","),finishX=Number(temp5[0]),boxes[0]={x:finishX,y:Number(temp5[1]),width:Number(temp5[2]),height:Number(temp5[3]),type:2}}var player={x:spawnX,y:spawnY,width:10,height:15,speed:4,velX:0,velY:0,jumping:!0,grounded:!1};for(generation=1,nnOut={up:0,left:0,right:0},gateIn={A:!1,B:!1},networkNumber=1,baseNetwork=[],baseNetwork[0]=[],i=1;i<=gatesAmt;i++)baseNetwork[i]=[],baseNetwork[i][1]=!1;function update(){for((deathwall+=3)>=player.x&&death(),keys[38]&&!player.jumping&&player.grounded&&(player.jumping=!0,player.grounded=!1,player.velY=2*-player.speed,play_multi_sound("jump")),keys[39]&&player.velX<player.speed&&player.velX++,keys[37]&&player.velX>-player.speed&&player.velX--,player.velX*=friction,player.velY+=gravity,ctx.fillStyle="white",ctx.fillRect(0,0,canvas.width,canvas.height),ctx.fillStyle="black",ctx.beginPath(),player.grounded=!1,y=0;y<boxes.length;y++){var e=colCheck(player,boxes[y]);"l"===e||"r"===e?(player.velX=0,player.jumping=!1):"b"===e?(player.grounded=!0,keys[38]||(player.jumping=!1)):"t"===e&&(player.velY*=-1),0==boxes[y].type&&(ctx.fillStyle="black"),1==boxes[y].type&&(ctx.fillStyle="red"),2==boxes[y].type&&(ctx.fillStyle="limegreen"),ctx.fillRect(boxes[y].x,boxes[y].y,boxes[y].width,boxes[y].height),ctx.fill()}for(player.grounded&&(player.velY=0),player.y>canvas.height&&death(),player.x+=player.velX,player.y+=player.velY,ctx.font="10px monospace",ctx.fill(),ctx.fillStyle="darkorange",ctx.fillRect(player.x,player.y,player.width,player.height),ctx.strokeStyle="red",ctx.beginPath(),ctx.moveTo(player.x+player.width/2,player.y+player.height/2),ctx.lineTo(player.x+player.width/2+20*player.velX,player.y+player.height/2+20*player.velY),ctx.stroke(),ctx.strokeStyle="blue",ctx.beginPath(),ctx.moveTo(player.x+player.width/2,player.y+player.height/2),ctx.lineTo(player.x+player.width/2,player.y+player.height/2+20*player.velY),ctx.stroke(),ctx.strokeStyle="green",ctx.beginPath(),ctx.moveTo(player.x+player.width/2,player.y+player.height/2),ctx.lineTo(player.x+player.width/2+20*player.velX,player.y+player.height/2),ctx.stroke(),ctx.strokeStyle="red",ctx.lineWidth=3,ctx.beginPath(),ctx.moveTo(deathwall,0),ctx.lineTo(deathwall,canvas.height),ctx.stroke(),ctx.lineWidth=1,i=1;i<=blood.amt;i++)ctx.fillStyle="red",ctx.fillRect(blood.x[i]-blood.size/2,blood.y[i]-blood.size/2,blood.size,blood.size),blood.x[i]+=blood.velx[i],blood.y[i]+=blood.vely[i],blood.velx[i]*=.8,blood.vely[i]+=.3;for(i=-1*Math.floor(obDim/2);i<=Math.floor(obDim/2);i++)for(j=-1*Math.floor(obDim/2);j<=Math.floor(obDim/2);j++)ctx.fillStyle="blue",ctx.fillRect(i*eye.dist+player.x+player.width/2,j*eye.dist+player.y+player.height/2,2,2);ctx.fillStyle="black",ctx.fillText("player.jumping = "+player.jumping,3,10),ctx.fillText("player.x = "+Math.round(player.x),3,20),ctx.fillText("player.y = "+Math.round(player.y),3,30),ctx.fillText("Mouse Coordinates: "+mouseX+", "+mouseY,3,40),ctx.fillText("Deathwall Position: "+Math.round(deathwall),3,50),ctx.fillText("player.grounded: "+player.grounded,3,60),ctx.fillText("Last Fitness: "+Math.round(lastfitness),3,70),ctx.fillText("Network Number: "+networkNumber,3,80),ctx.fillText("Generation: "+generation,3,90),ctx.fillText("Evolve Amount: "+evolveAmt,3,100),ctx.fillText("Continuity = "+continuity,3,110),requestAnimationFrame(update)}function colCheck(e,t){var l=e.x+e.width/2-(t.x+t.width/2),i=e.y+e.height/2-(t.y+t.height/2),a=Math.abs(e.width/2)+Math.abs(t.width/2),o=Math.abs(e.height/2)+Math.abs(t.height/2),r=null;if(Math.abs(l)<a&&Math.abs(i)<o)if(0==boxes[y].type){var h=a-Math.abs(l),n=o-Math.abs(i);h>=n?i>0?(r="t",e.y+=n):(r="b",e.y-=n):l>0?(r="l",e.x+=h):(r="r",e.x-=h)}else 1==boxes[y].type?death():2==boxes[y].type&&victory();return r}function death(){for(play_multi_sound("death"),lastfitness=player.x,deathwall=-300,player.velX=0,player.velY=0,k=1;k<=blood.amt;k++)blood.velx[k]=30*Math.random()-15,blood.vely[k]=12*Math.random()-6,blood.vector[k]=Math.sqrt(blood.velx[k]*blood.velx[k]+8*blood.vely[k]*blood.vely[k]),blood.vector[k]>=blood.limit&&(blood.velx[k]*=blood.limit/blood.vector[k],blood.vely[k]*=blood.limit/blood.vector[k]),blood.x[k]=player.x,blood.y[k]=player.y;player.x=spawnX,player.y=spawnY}function victory(){play_multi_sound("win"),lastfitness=finishX,deathwall=-300,player.velX=0,player.velY=0,player.x=spawnX,player.y=spawnY}baseNetwork[0][1]=20,baseNetwork[0][2]=-300,evolveAmt=2,generationFitness=[],generationFitness[0]=20,lastBaseNet=0,continuity=0,document.body.addEventListener("keydown",(function(e){keys[e.keyCode]=!0})),document.body.addEventListener("keyup",(function(e){keys[e.keyCode]=!1})),canvas.addEventListener("mousemove",(function(e){mouseX=e.clientX-canvas.offsetLeft,mouseY=e.clientY-canvas.offsetTop}),!1),window.addEventListener("load",(function(e){e.clientX,canvas.offsetLeft,e.clientY,canvas.offsetTop;update()}));
</script>